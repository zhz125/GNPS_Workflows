<?xml version="1.0" encoding="ISO-8859-1" ?>
<interface id="ming_test" version="1.2.3">
    <!-- View definitions -->
    <download>
                <source type="folder" name="clusterinfo/"/>
                <source type="folder" name="clusterinfosummary/"/>
                <source type="folder" name="clusterinfogroup/"/>
                <source type="folder" name="clusterinfosummarygroup/"/>
                <source type="folder" name="clusterinfosummarygroup_attributes/"/>
                <source type="folder" name="clusterinfosummarygroup_attributes_withIDs/"/>
                <source type="folder" name="clusterinfosummarygroup_attributes_withIDs_withcomponentID/"/>
                <source type="folder" name="clusterinfosummarygroup_attributes_withIDs_arbitraryattribute/"/>
                <source type="folder" name="networkedges/"/>
                <source type="folder" name="networkedges_selfloop/"/>
                <source type="folder" name="result_specnets_DB/"/>
                <source type="folder" name="groupmapping_converted/"/>
                <!--<source type="file" name="spectra/specs_ms.mgf"/>-->
        </download>

	<view id="clone_updated_networking" label="Clone Job to Latest Molecular Networking V2 Workflow" group="Clone to Latest Networking Workflow">
            <blockRef id="main"   type="clone_updated_networking"/>
        </view>
	<block id="clone_updated_networking" type="dummylinkout">
          <data>
             <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
          </data>
            <parameter name="URLBASE" value='https://gnps.ucsd.edu/ProteoSAFe/index.jsp?task=[task]&amp;params=%7B"workflow":"METABOLOMICS-SNETS-V2"%7D'/>

        </block>


        <view id="parameters_display" label="Networking Parameters and Written Network Description" group="Methods and Citation for Manuscripts">
                <blockRef id="main" type="parameters_display"/>
        </view>

        <block id="parameters_display" type="parametersdisplayer">
            <data>
                <source type="file" name="result/"/>
                <parsers>
                    <parser type="stream" contentType="text/plain"/>
                </parsers>
            </data>
        </block>



        <view id="task_data_reuse" label="Reanalyze Cluster Spectra" group="Experimental Views">
                <blockRef id="main" type="task_data_reuse"/>
        </view>
        <block id="task_data_reuse" type="task_data_reuse">
            <data>
                <source type="file" name="result/"/>
                <parsers>
                    <parser type="stream" contentType="text/plain"/>
                </parsers>
            </data>
        </block>

        <view id="view_all_topology_signatures" label="Topology Signatures" group="Experimental Views">
                <blockRef id="main"   type="view_all_topology_signatures"/>
        </view>
        <block id="view_all_topology_signatures" type="table">
                <data>
                    <source type="file" name="all_network_paths/"/>
                <parsers>
                    <parser type="sortedTabular" sortBy="DeltaKey" operator="ascending"/>
                </parsers>
            </data>
            <row>
                        <column type="integer"     field="Delta1"         label="Delta1"            width="3"/>
                        <column type="integer"     field="Delta2"         label="Delta2"            width="3"/>
                        <column type="integer"     field="Delta3"         label="Delta3"            width="3"/>
                        <column type="text"     field="DeltaKey"        label="DeltaKey"          width="20"/>
                        <column type="text"     field="Nodes"        label="Nodes"          width="40"/>
            </row>
        </block>

        <view id="view_all_topology_signatures_histogram" label="Topology Signatures Histogram" group="Experimental Views">
                <blockRef id="main"   type="view_all_topology_signatures_histogram"/>
        </view>
        <block id="view_all_topology_signatures_histogram" type="table">
                <data>
                    <source type="file" name="all_network_paths_histogram/"/>
                <parsers>
                    <parser type="sortedTabular" sortBy="count" operator="descending"/>
                </parsers>
            </data>
            <row>
                        <column type="integer"     field="Delta1"         label="Delta1"            width="3"/>
                        <column type="integer"     field="Delta2"         label="Delta2"            width="3"/>
                        <column type="integer"     field="Delta3"         label="Delta3"            width="3"/>
                        <column type="integer"     field="count"         label="count"            width="3"/>
                        <column type="text"     field="delta_key"        label="delta_key"          width="10"/>
                        <column label="View Paths" type="genericurlgenerator" width="12" field="delta_key">
                            <parameter name="URLBASE" value="/ProteoSAFe/result.jsp"/>
                            <parameter name="REQUESTPARAMETER=view" value="view_all_topology_signatures"/>
                            <parameter name="HASHPARAMTER=DeltaKey_input" value="[delta_key]"/>
                            <parameter name="LABEL" value="View Paths"/>
                            <parameter name="USETASK" value="True"/>
                        </column>
            </row>
        </block>



        <!--VIEW NETWORK-->
        <view id="view_network" label="View Network, Node Centric" group="Auxiliary Views">
                <blockRef id="main" type="network_list_specnets"/>
        </view>
        <block id="network_list_specnets" type="table">
                <data>
                        <source type="file" name="networkedges_display/"/>
                        <parsers>
                                <parser type="sortedTabular" sortBy="Node1" operator="ascending"/>
                                <parser type="representativeTabular" groupBy="Node1" selectBy="Cos_Score" operator="max"/>
                        </parsers>
                </data>
                <row>
                        <column type="integer"        field="Node1" label="Node Index"        width="10"/>
                </row>

                <row expander="down:up">
                  <column type="block" block="related_network_list_specnets" colspan="7">
                    <parameter name="spectraid" value="[Node1]"/>
                  </column>
                </row>
        </block>




        <view id="view_mz_histogram" label="Nodes, MZ Histogram" group="Advanced Views - Networking Graphs">
                <blockRef id="main"   type="view_mz_histogram"/>
        </view>

        <block id="view_mz_histogram" type="histogramdisplayer" viewname="view_all_clusters_withID_beta" columnname="parent mass">
                <data>
                    <source type="file" name="all_network_paths_histogram/"/>
                <parsers>
                    <parser type="stream" contentType="text/plain"/>
                </parsers>
            </data>
        </block>






        <view id="view_edges_delta_histogram" label="Edges, MZ Delta Histogram" group="Advanced Views - Networking Graphs">
                <blockRef id="main"   type="view_edges_delta_histogram"/>
        </view>

        <block id="view_edges_delta_histogram" type="histogramdisplayer" viewname="view_network_pairs" columnname="MzDiff">
                <data>
                    <source type="file" name="all_network_paths_histogram/"/>
                <parsers>
                    <parser type="stream" contentType="text/plain"/>
                </parsers>
            </data>
        </block>

        <view id="view_scatter_edge_score_to_delta" label="Edges, Score vs MZ Delta Plot" group="Advanced Views - Networking Graphs">
                <blockRef id="main"   type="view_scatter_edge_score_to_delta"/>
        </view>

        <block id="view_scatter_edge_score_to_delta" type="scatterplotdisplayer" viewname="view_network_pairs" xname="MzDiff" yname="Cos_Score">
                <data>
                    <source type="file" name="all_network_paths_histogram/"/>
                <parsers>
                    <parser type="stream" contentType="text/plain"/>
                </parsers>
            </data>
        </block>

        <view id="view_ppm_error_search_histogram" label="Library Search, PPM Error Histogram" group="Advanced Views - Networking Graphs">
                <blockRef id="main"   type="view_ppm_error_search_histogram"/>
        </view>

        <block id="view_ppm_error_search_histogram" type="histogramdisplayer" viewname="view_all_annotations_DB" columnname="MZErrorPPM">
                <data>
                    <source type="file" name="all_network_paths_histogram/"/>
                <parsers>
                    <parser type="stream" contentType="text/plain"/>
                </parsers>
            </data>
        </block>








        <view id="view_all_datasets_matched" label="Dataset Matches" group="Community Matches">
                <blockRef id="main"   type="view_all_datasets_matched"/>
        </view>

        <block id="view_all_datasets_matched" type="table">
                <data>
                    <source type="file" name="all_dataset_matches/"/>
                <parsers>
                    <parser type="sortedTabular" sortBy="score" operator="descending"/>
                </parsers>
            </data>
            <row>
                <column type="text"     field="specs_filename"         label="specs_filename"            width="10"/>
                <column type="text"     field="specs_scan"         label="specs_scan"            width="10"/>
                <column type="text"     field="dataset_id"         label="dataset_id"            width="30"/>
                <column type="text"     field="dataset_title"         label="dataset_title"            width="40"/>
                <column type="float"     field="score"         label="score"            precision="2"/>
                <column type="text"     field="Compound_Name"         label="Compound_Name"            width="10"/>
                <column type="integer"     field="dataset_neighbors"         label="dataset_neighbors"            precision="2"/>
            </row>
            <row expander="image">
                <column type="jscolumnspectrumviewer_spectrum_comparison" colspan="5">
                    <parameter name="spectrum1_type"    value="flatfile"/>
                    <parameter name="spectrum1_file"    file="spectra/[specs_filename]"/>>
                    <parameter name="spectrum1_scan"    value="[specs_scan]"/>
                    <parameter name="spectrum2_type"    value="flatfile"/>
                    <parameter name="spectrum2_file"    value="FILE->../../../../../../../../data/ccms-data/uploads/[dataset_filename]"/>
                    <parameter name="spectrum2_scan"    value="[dataset_scan]"/>
                </column>
            </row>
        </block>




        <view id="view_emporer" label="View Emporer PCoA Plot in GNPS" group="Advanced Views - Third Party Visualization">
            <blockRef id="main" type="view_emporer"/>
        </view>
        <block id="view_emporer" type="streamhtmlframe">
            <data>
                <source type="file" name="view_emporer/"/>
                <parsers>
                    <parser type="stream" contentType="text/html"/>
                </parsers>
            </data>
        </block>



        <view id="network_components" label="View Spectral Families (In Browser Network Visualizer)" group="Network Visualizations">
                <blockRef id="main" type="network_components"/>
        </view>
        <block id="network_components" type="table">
                <data>
                        <source type="file" name="networkcomponents/"/>
                        <parsers>
                                <parser type="sortedTabular" sortBy="NodeCount" operator="descending"/>
                        </parsers>
                </data>
                <row>
                        <column label="Visualize Network" type="genericurlgenerator" width="12" field="ComponentIndex"> \
                            <parameter name="URLBASE" value="/ProteoSAFe/result.jsp"/>\
                            <parameter name="REQUESTPARAMETER=view" value="network_displayer"/>\
                            <parameter name="REQUESTPARAMETER=componentindex" value="[ComponentIndex]"/>\
                            <parameter name="LABEL" value="Visualize Network"/>\
                            <parameter name="USETASK" value="True"/>\
                        </column>\

                        <column label="View Network Nodes" type="genericurlgenerator" width="12" field="ComponentIndex"> \
                            <parameter name="URLBASE" value="/ProteoSAFe/result.jsp"/>\
                            <parameter name="REQUESTPARAMETER=view" value="cluster_info_sliced"/>\
                            <parameter name="REQUESTPARAMETER=componentindex" value="[ComponentIndex]"/>\
                            <parameter name="REQUESTPARAMETER=show" value="true"/>\
                            <parameter name="LABEL" value="Network Nodes"/>\
                            <parameter name="USETASK" value="True"/>\
                        </column>\

                        <column type="integer"        field="NodeCount" label="NodeCount"        width="5"/>
                        <column type="float"       field="%ID"       label="%ID"           precision="3" />
                        <column type="integer"       field="#Spectra"           label="#Spectra"             width="5"/>
                        <column type="expandable"       field="AllIDs"           label="AllIDs"             width="10"/>
                        <column type="expandable"       field="DefaultGroups"           label="DefaultGroups"             width="10"/>
                        <column type="expandable"       field="UserGroups"           label="UserGroups"             width="10"/>
                </row>
        </block>






    <view id="download_clustered_spectra" label="Download Clustered Spectra as MGF" group="Export">
            <blockRef id="main"   type="download_clustered_spectra"/>
    </view>


    <block id="download_clustered_spectra" type="dummydownload">
      <data>
        <source type="file" name="spectra/specs_ms.mgf"/>
         <parsers>
            <parser type="stream" contentType="text/xml"/>
        </parsers>
      </data>
    </block>
































































        <view id="view_all_annotations_DB" label="View All Library Hits">
                <blockRef id="main"   type="view_all_annotations_DB"/>
        </view>

        <view id="group_by_organism_DB" label="Group by Organism DB" display="hidden">
                <blockRef id="main" type="organism_list_DB"/>
        </view>

        <view id="organism_details_DB" display="hidden">
                <blockRef id="main" type="spectra_per_organism_DB"/>
        </view>

    <view id="group_by_spectrum_specnets" label="Group by Spectrum Specnets" display="hidden">
                <blockRef id="main" type="spectrum_list_specnets"/>
        </view>

        <view id="view_all_clusters" label="View All Clusters" display="hidden">
                <blockRef id="main" type="clusters_list_specnets"/>
        </view>

        <view id="view_all_clusters_withID" label="View All Clusters With IDs" group="Legacy Views" display="hidden">
                <blockRef id="main" type="clusters_list_specnets_withID"/>
        </view>

        <view id="view_all_clusters_withID_beta" label="View All Clusters With IDs">
                <blockRef id="main" type="clusters_list_specnets_withID_beta"/>
        </view>



        <view id="cluster_details" display="hidden">
                <blockRef id="main" type="results_per_cluster"/>
        </view>

        <view id="view_related_network" display="hidden">
                <blockRef id="main" type="related_network_list_specnets"/>
        </view>


        <view id="view_network_pairs" label="View Network Pairs" group="Auxiliary Views">
                <blockRef id="main" type="network_pairs_specnets"/>
        </view>



        <view id="download_cytoscape_data" label="Download Cytoscape Data" group="Export">
                <blockRef id="main"   type="download_cytoscape_data"/>
        </view>


        <block id="download_cytoscape_data" type="dummydownload">
          <data>
             <source type="file" name="gnps_molecular_network_graphml/"/>
             <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
          </data>
        </block>

        <!-- Quantification Vizualization -->
        <view id="download_cluster_buckettable" label="Download Bucket Table" group="Export">
                <blockRef id="main"   type="download_cluster_buckettable"/>
        </view>


        <block id="download_cluster_buckettable" type="dummydownload">
          <data>
            <source type="file" name="cluster_buckets/"/>
             <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
          </data>
        </block>

        <view id="download_biom" label="Download BioM For Qiime/Qiita" group="Export">
                <blockRef id="main"   type="download_biom"/>
        </view>
        <block id="download_biom" type="dummydownload">
          <data>
            <source type="file" name="biom_output/"/>
             <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
          </data>
        </block>

        <view id="download_metadata" label="Download Metadata For Qiime" group="Export">
                <blockRef id="main"   type="download_metadata"/>
        </view>
        <block id="download_metadata" type="dummydownload">
          <data>
            <source type="file" name="metadata_for_qiime/"/>
             <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
          </data>
        </block>



        <view id="makedatasetlink" label="Make Public Dataset" group="Export">
                <blockRef id="main"   type="makedatasetlink"/>
        </view>


        <block id="makedatasetlink" type="dummylinkout">
          <data>
             <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
          </data>
            <parameter name="URLBASE" value="https://bix-lab.ucsd.edu/display/Public/GNPS+MassIVE+Dataset+Creation"/>
        </block>


        <view id="view_spectrum" display="hidden">
                <blockRef id="main"   type="view_spectrum"/>
        </view>


        <block id="view_spectrum" type="spectrumpage">
          <data>
            <source type="file" name="result/"/>
             <parsers>
                <parser type="stream" contentType="text/xml"/>
            </parsers>
          </data>
        </block>

        <block id="view_all_annotations_DB" type="table">
                <data>
                        <source type="file" name="result_specnets_DB/"/>
                        <parsers>
                                <parser type="sortedTabular" sortBy="MQScore" operator="descending"/>
                        </parsers>
                        <processors>
                                <processor type="uploadFilename" field="SpectrumFile"/>
                        </processors>
                </data>
                <row>
                        <column label="ViewLib" type="genericurlgenerator" width="5"> \
                            <parameter name="URLBASE" value="/ProteoSAFe/gnpslibraryspectrum.jsp"/>\
                            <parameter name="REQUESTPARAMETER=SpectrumID" value="[SpectrumID]"/>\
                            <parameter name="LABEL" value="ViewLib"/>\
                        </column>\

                        <column type="text"        field="Compound_Name" label="Compound_Name"        width="12"/>
                        <column type="integer"     field="#Scan#"         label="ClusterIdx"            width="3"/>
                        <column label="View All Spectra" type="genericurlgenerator" width="10" field="View Raw">
                            <parameter name="URLBASE" value="/ProteoSAFe/result.jsp"/>
                            <parameter name="REQUESTPARAMETER=view" value="cluster_details"/>
                            <parameter name="REQUESTPARAMETER=protein" value="[#Scan#]"/>
                            <parameter name="REQUESTPARAMETER=show" value="true"/>
                            <parameter name="LABEL" value="View Raw Spectra"/>
                            <parameter name="USETASK" value="True"/>
                        </column>
                        <column type="text"     field="LibraryQualityString"         label="Library Class"            width="5"/>

                        <column type="float"     field="MQScore"         label="Cosine"            precision="2"/>
                        <column type="integer"     field="SharedPeaks"         label="SharedPeaks"            width="3"/>
                        <column type="float"     field="TIC_Query"         label="TIC Query"            precision="2"/>
                        <column type="float"     field="RT_Query"         label="RT Query"           precision="2" />
                        <column type="integer"     field="MZErrorPPM"         label="MZErrorPPM"            />

                        <column type="float"     field="MassDiff"         label="MassDiff"            precision="2"/>
                        <column type="float"     field="SpecMZ"         label="SpecMZ"            precision="2"/>
                        <column type="float"     field="LibMZ"         label="LibMZ"            precision="2"/>

                        <column type="text"     field="Instrument"         label="Instrument"            width="5"/>
                        <columbiomn type="text"     field="IonMode"         label="IonMode"            width="5"/>
                        <column type="text"     field="PI"         label="PI"            width="5"/>
                        <column type="text"     field="Ion_Source"         label="Ion Source"            width="5"/>
                        <column type="text"     field="tags"         label="Tags"            width="5"/>
                        <column label="Add Library Tag" type="addspectrumtag" width="12">
                            <parameter name="spectrumID" value="[SpectrumID]"/>
                        </column>
                        <column type="structuredisplayer"     label="Structure">
                            <parameter name="smilesstructure" value="[Smiles]"/>
                        </column>
                </row>
                <row expander="image">
                    <column type="jscolumnspectrumviewer_spectrum_comparison" colspan="5">
                            <parameter name="spectrum1_type"    value="flatfile"/>
                            <!-- <parameter name="spectrum1_file"    file="spectra/[internalFilename]"/>> -->
                            <parameter name="spectrum1_file"    file="spectra/specs_ms.mgf"/>>
                            <parameter name="spectrum1_scan"    value="[#Scan#]"/>
                            <parameter name="spectrum2_type"    value="lib"/>
                            <parameter name="spectrum2_spectrumid"    value="[SpectrumID]"/>
                    </column>
                    <column type="jscolumnspectrumviewer" colspan="5" label="Query" width="550" height="350">
                            <!-- <parameter name="file"    file="spectra/[internalFilename]"/> -->
                            <parameter name="file"    file="spectra/specs_ms.mgf"/>
                            <parameter name="scan"    value="[#Scan#]"/>
                            <parameter name="compoundname" value="*..*"/>
                    </column>
                    <column type="jscolumnspectrumviewer" colspan="5" label="Library" width="550" height="350">
                            <parameter name="file"    file="lib/[LibraryName]"/>
                            <parameter name="spectrumid"    value="[SpectrumID]"/>
                            <parameter name="compoundname" value="*..*"/>
                    </column>

                </row>
        </block>


        <view id="view_all_annotations_legacy" label="View All Library Hits" display="hidden">
                <blockRef id="main"   type="view_all_annotations_legacy"/>
        </view>

        <block id="view_all_annotations_legacy" type="table">
                <data>
                        <source type="file" name="result_specnets/"/>
                        <parsers>
                                <parser type="sortedTabular" sortBy="MQScore" operator="descending"/>
                        </parsers>
                </data>
                <row>
                        <column type="text"        field="CompoundName" label="Compound_Name"        width="12"/>
                        <column type="integer"     field="#Scan#"         label="ClusterIdx"            width="3"/>
                        <column type="float"     field="MQScore"         label="Cosine"            precision="2"/>
                        <column type="integer"     field="SharedPeaks"         label="SharedPeaks"            width="3"/>
                        <column type="float"     field="TIC_Query"         label="TIC Query"            precision="2"/>
                        <column type="float"     field="RT_Query"         label="RT Query"           precision="2" />
                        <column type="integer"     field="MZErrorPPM"         label="MZErrorPPM"            />

                        <column type="float"     field="MassDiff"         label="MassDiff"            precision="2"/>
                        <column type="float"     field="SpecMZ"         label="SpecMZ"            precision="2"/>
                        <column type="float"     field="LibMZ"         label="LibMZ"            precision="2"/>

                        <column type="text"     field="Instrument"         label="Instrument"            width="5"/>
                        <columbiomn type="text"     field="IonMode"         label="IonMode"            width="5"/>
                        <column type="text"     field="PI"         label="PI"            width="5"/>
                        <column type="text"     field="Ion_Source"         label="Ion Source"            width="5"/>
                        <column type="text"     field="tags"         label="Tags"            width="5"/>
                </row>
                <row expander="image">
                    <column type="jscolumnspectrumviewer_spectrum_comparison" colspan="5">
                            <parameter name="spectrum1_type"    value="flatfile"/>
                            <!-- <parameter name="spectrum1_file"    file="spectra/[internalFilename]"/>> -->
                            <parameter name="spectrum1_file"    file="spectra/specs_ms.mgf"/>>
                            <parameter name="spectrum1_scan"    value="[#Scan#]"/>
                            <parameter name="spectrum2_type"    value="lib"/>
                            <parameter name="spectrum2_spectrumid"    value="[SpectrumID]"/>
                    </column>
                    <column type="jscolumnspectrumviewer" colspan="5" label="Query" width="550" height="350">
                            <!-- <parameter name="file"    file="spectra/[internalFilename]"/> -->
                            <parameter name="file"    file="spectra/specs_ms.mgf"/>
                            <parameter name="scan"    value="[#Scan#]"/>
                            <parameter name="compoundname" value="*..*"/>
                    </column>
                    <column type="jscolumnspectrumviewer" colspan="5" label="Library" width="550" height="350">
                            <parameter name="file"    file="lib/[LibraryName]"/>
                            <parameter name="spectrumid"    value="[SpectrumID]"/>
                            <parameter name="compoundname" value="*..*"/>
                    </column>

                </row>
        </block>

        <view id="group_by_compound" label="View All Compounds" >
            <blockRef id="main" type="group_by_compound"/>
        </view>

        <block id="group_by_compound" type="table">
                <data>
                        <source type="file" name="result_specnets_DB/"/>
                        <parsers>
                                <parser type="sortedTabular"         sortBy="MQScore"      operator="descending"/>
                                <parser type="representativeTabular" groupBy="Compound_Name" selectBy="MQScore" operator="max"/>
                        </parsers>
                        <processors>
                                <processor type="uploadFilename" field="SpectrumFile"/>
                        </processors>
                </data>
                <row>
                    <column label="ViewLib" type="genericurlgenerator" width="5"> \
                        <parameter name="URLBASE" value="/ProteoSAFe/gnpslibraryspectrum.jsp"/>\
                        <parameter name="REQUESTPARAMETER=SpectrumID" value="[SpectrumID]"/>\
                        <parameter name="LABEL" value="ViewLib"/>\
                    </column>\

                        <column type="text"        field="Compound_Name" label="Compound_Name"        width="12"/>
                        <column type="text"     field="LibraryQualityString"         label="Library Class"            width="5"/>
                        <column type="float"     field="MQScore"         label="Cosine"            precision="2"/>
                        <column type="integer"     field="MZErrorPPM"         label="MZErrorPPM"            />
                        <column type="float"     field="MassDiff"         label="MassDiff"            precision="3"/>
                        <column type="float"     field="LibMZ"         label="LibMZ"            precision="2"/>
                        <column type="text"     field="Instrument"         label="Instrument"            width="5"/>
                        <column type="text"     field="IonMode"         label="IonMode"            width="5"/>
                        <column type="text"     field="PI"         label="PI"            width="5"/>
                        <column type="text"     field="Ion_Source"         label="Ion Source"            width="5"/>
                        <column type="text"     field="tags"         label="Tags"            width="5"/>
                        <column label="Add Library Tag" type="addspectrumtag" width="12">
                            <parameter name="spectrumID" value="[SpectrumID]"/>
                        </column>
                        <column type="structuredisplayer"     label="Structure">
                            <parameter name="smilesstructure" value="[Smiles]"/>
                        </column>
                </row>
                <row expander="image">
                        <column type="jscolumnspectrumviewer" colspan="5" label="Query" width="550" height="350">
                                <parameter name="file"    file="spectra/specs_ms.mgf"/>
                                <parameter name="scan"    value="[#Scan#]"/>
                                <parameter name="compoundname" value="*..*"/>
                                <parameter name="trim" value="true"/>
                        </column>
                        <column type="jscolumnspectrumviewer" colspan="5" label="Library" width="550" height="350">
                                <parameter name="file"    file="lib/[LibraryName]"/>
                                <parameter name="spectrumid"    value="[SpectrumID]"/>
                                <parameter name="compoundname" value="*..*"/>
                                <parameter name="trim" value="true"/>
                        </column>
                </row>
        </block>



        <block id="organism_list_DB" type="table">
                <data>
                        <source type="file" name="result_specnets_DB/"/>
                        <parsers>
                                <parser type="groupedTabular" groupBy="Organism"/>
                        </parsers>

                </data>
                <row>
                        <column type="view" view="organism_details_DB" field="Organism" label="Organism" width="18">
                                <parameter name="protein"   value="[Organism]"/>
                                <parameter name="proteinID" value="[Organism]"/>
                        </column>

                        <column type="text"     field="Organism"   label="Organism"                width="18"/>
                        <column type="integer"  field="Hits"      label="Hits"                       width="2"/>
                </row>

        </block>

        <block id="spectra_per_organism_DB" type="table">
                <data>
                        <source type="file" name="result_specnets_DB/"/>
                        <parsers>
                                <parser type="slicedTabular" groupBy="Organism" sliceBy="{protein}"/>
                        </parsers>
                        <processors>
                                <processor type="uploadFilename" field="SpectrumFile"/>
                        </processors>

                </data>
                <row>
                        <column type="text"        field="Compound_Name" label="Compound_Name"        width="12"/>
                        <column type="integer"     field="#Scan#"         label="Scan"            width="3"/>
                        <!--<column type="text"     field="SpectrumID"         label="SpectrumID"            width="15"/>-->
                        <column type="text"     field="LibraryQualityString"         label="Library Class"            width="5"/>

                        <column type="float"     field="MQScore"         label="Cosine"            precision="2"/>
                        <column type="integer"     field="SharedPeaks"         label="SharedPeaks"            width="3"/>
                        <column type="float"     field="TIC_Query"         label="TIC Query"            precision="2"/>
                        <column type="float"     field="RT_Query"         label="RT Query"           precision="2" />
                        <column type="integer"     field="MZErrorPPM"         label="MZErrorPPM"            />
                        <column type="text"     field="Organism"         label="Organism"            width="3"/>

                        <column type="integer"     field="MassDiff"         label="MassDiff"            width="3"/>
                        <column type="float"     field="LibMZ"         label="LibMZ"            precision="2"/>

                        <column type="text"     field="Instrument"         label="Instrument"            width="5"/>
                        <column type="text"     field="IonMode"         label="IonMode"            width="5"/>
                        <column type="text"     field="PI"         label="PI"            width="5"/>
                        <column type="text"     field="Ion_Source"         label="Ion Source"            width="5"/>

                        <column type="mingplugin" target="/" label="Update">
                          <parameter name="workflow" value="[UpdateWorkflowName]"/>
                          <parameter name="SPECTRUMID" value="[SpectrumID]"/>
                          <parameter name="ADDSPECTRA_LIBQUALITY" value="[Library_Class]"/>
                          <parameter name="ADDSPECTRA_IONSOURCE" value="[Ion_Source]"/>
                          <parameter name="ADDSPECTRA_INSTRUMENT" value="[Instrument]"/>
                          <parameter name="ADDSPECTRA_IONMODE" value="[IonMode]"/>
                          <parameter name="ADDSPECTRA_ACQUISITION" value="[Compound_Source]"/>
                          <parameter name="ADDSPECTRA_SMILES" value="[Smiles]"/>
                          <parameter name="ADDSPECTRA_INCHI" value="[INCHI]"/>
                          <parameter name="ADDSPECTRA_INCHIAUX" value="[INCHI_AUX]"/>
                          <parameter name="ADDSPECTRA_CASNUMBER" value="[CAS_Number]"/>
                          <parameter name="ADDSPECTRA_PUB" value="[Pubmed_ID]"/>
                          <parameter name="ADDSPECTRA_PI" value="[PI]"/>
                          <parameter name="ADDSPECTRA_DATACOLLECTOR" value="[Data_Collector]"/>
                          <parameter name="ADDSPECTRA_EXACTMASS" value="[ExactMass]"/>
                          <parameter name="ADDSPECTRA_ADDUCT" value="[Adduct]"/>
                          <parameter name="ADDSPECTRA_CHARGE" value="[Charge]"/>
                          <parameter name="ADDSPECTRA_MOLECULEMASS" value="[Precursor_MZ]"/>
                          <parameter name="ADDSPECTRA_COMPOUND_NAME" value="[Compound_Name]"/>
                        </column>
                </row>
                <row expander="image">
                        <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                                <parameter name="file"    file="spectra/[internalFilename]"/>
                                <parameter name="scan"    value="[#Scan#]"/>
                                <parameter name="peptide" value="*..*"/>
                                <parameter name="trim" value="true"/>
                        </column>
                        <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                            <parameter name="file"    file="lib/[LibraryName]"/>
                            <parameter name="spectrumid"    value="[SpectrumID]"/>
                            <parameter name="peptide" value="*..*"/>
                            <parameter name="trim" value="true"/>
                        </column>
                </row>

        </block>

    <block id="spectrum_list_specnets" type="table">
                <data>
                        <source type="file" name="result_specnets/"/>
                        <parsers>
                                <parser type="sortedTabular" sortBy="SpectrumFile" operator="ascending"/>
                                <parser type="representativeTabular" groupBy="FileScanUniqueID" selectBy="MQScore" operator="max"/>
                        </parsers>
                        <processors>
                                <processor type="uploadFilename" field="SpectrumFile"/>
                        </processors>
                </data>
                <row>
                        <column type="text"        field="SpectrumFile" label="Filename"        width="12"/>
                        <column type="integer"     field="#Scan#"         label="Scan"            width="3"/>
                        <column type="integer"     field="Charge"        label="Charge"          width="1"/>
                        <column type="float"       field="MQScore"       label="Score"           precision="5"/>
                        <column type="text"        field="CompoundName"    label="CompoundName"         width="18"/>
                        <column type="text"        field="Organism"    label="Organism"         width="30"/>
            <column type="integer"        field="LibSearchSharedPeaks"    label="SharedPeaks"         width="2"/>
            <column type="float"        field="mzErrorPPM"    label="mzErrorPPM"         width="5"/>
                </row>
                <row expander="image">
                        <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                                <parameter name="file"    file="spectra/[internalFilename]"/>
                                <parameter name="scan"    value="[#Scan#]"/>
                                <parameter name="peptide" value="[Annotation]"/>
                                <parameter name="trim" value="true"/>
                        </column>
                        <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                                <parameter name="file"    file="lib/[LibraryName]"/>
                                <parameter name="scan"    value="[dbIndex]"/>
                                <parameter name="peptide" value="[Annotation]"/>
                                <parameter name="trim" value="true"/>
                        </column>
                </row>
                <row expander="down:up">
            <column type="block" block="results_per_spectrum_specnets" colspan="7">
                <parameter name="spectraid" value="[FileScanUniqueID]"/>
            </column>
        </row>
        </block>

        <block id="results_per_spectrum_specnets" type="table">
        <data>
            <source type="file" name="result_specnets/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="MQScore" operator="ascending"/>
                <parser type="slicedTabular" groupBy="FileScanUniqueID" sliceBy="{spectraid}"/>
            </parsers>
            <processors>
                <processor type="uploadFilename" field="SpectrumFile"/>
            </processors>
        </data>
        <row>
            <column type="text"        field="SpectrumFile" label="Filename"        width="12"/>
            <column type="integer"     field="#Scan#"         label="Scan"            width="3"/>
            <column type="integer"     field="Charge"        label="Charge"          width="1"/>
            <column type="float"       field="MQScore"       label="Score"           precision="5"/>
            <column type="float"       field="FDR"           label="FDR"             precision="5"/>
            <column type="text"        field="CompoundName"    label="CompoundName"         width="18"/>
                        <column type="text"        field="Organism"    label="Organism"         width="30"/>
        </row>
        <row expander="image">
            <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                <parameter name="file"    file="spectra/[internalFilename]"/>
                <parameter name="scan"    value="[#Scan#]"/>
                <parameter name="peptide" value="[Annotation]"/>
                <parameter name="trim" value="true"/>
            </column>
            <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                <parameter name="file"    file="lib/[LibraryName]"/>
                <parameter name="scan"    value="[dbIndex]"/>
                <parameter name="peptide" value="[Annotation]"/>
                <parameter name="trim" value="true"/>
            </column>
        </row>
        </block>

        <block id="clusters_list_specnets" type="table">
                <data>
                        <source type="file" name="clusterinfosummarygroup_attributes/"/>
                        <parsers>
                                <parser type="sortedTabular" sortBy="cluster index" operator="ascending"/>
                        </parsers>
<!--                        <processors>
                                <processor type="uploadFilename" field="SpectrumFile"/>
                        </processors>-->
                </data>
                <row>
                        <column type="view" view="cluster_details" field="cluster index" label="ClusterIndex" width="18">
                                <parameter name="protein"   value="[cluster index]"/>
                                <parameter name="proteinID" value="[cluster index]"/>
                        </column>

                        <column type="integer"     field="number of spectra"        label="NumSpectra"          width="3"/>
                        <column type="float"       field="precursor mass"       label="PrecursorMZ"           precision="5"/>
                        <column type="float"        field="sum(precursor intensity)"    label="PrecursorInt"         precision="5"/>
                        <column type="float"        field="RTMean"    label="RTMean"         width="5"/>
                        <column type="text"        field="AllGroups"    label="AllGroups"         width="5"/>
                        <column type="text"        field="DefaultGroups"    label="DefaultGroups"         width="5"/>
                </row>
                <row expander="image">
                  <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                      <parameter name="file"    file="spectra/specs_ms.mgf"/>
                      <parameter name="scan"    value="[cluster index]"/>
                      <parameter name="peptide" value="*..*"/>
                      <parameter name="trim" value="true"/>
                  </column>
                </row>

                <row expander="down:up">
                  <column type="block" block="related_network_list_specnets" colspan="7">
                    <parameter name="spectraid" value="[cluster index]"/>
                  </column>
                </row>
        </block>


        <block id="clusters_list_specnets_withID" type="table">
                <data>
                        <source type="file" name="clusterinfosummarygroup_attributes_withIDs/"/>
                        <parsers>
                                <parser type="sortedTabular" sortBy="cluster index" operator="ascending"/>
                        </parsers>
<!--                        <processors>
                                <processor type="uploadFilename" field="SpectrumFile"/>
                        </processors>-->
                </data>
                <row>
                        <column type="view" view="cluster_details" field="cluster index" label="ClusterIndex" width="18">
                                <parameter name="protein"   value="[cluster index]"/>
                                <parameter name="proteinID" value="[cluster index]"/>
                        </column>

                        <column type="parameterlink" target="result.jsp" label="AddToLibrary" includetask="true">
                          <parameter name="view" value="cluster_details"/>
                          <parameter name="protein" value="[cluster index]"/>
                        </column>

                        <column type="parameterlink" target="result.jsp" label="+Challenge" includetask="true">
                          <parameter name="view" value="cluster_details"/>
                          <parameter name="protein" value="[cluster index]"/>
                        </column>

                        <column type="integer"     field="number of spectra"        label="NumSpectra"          width="3"/>
                        <column type="float"       field="precursor mass"       label="PrecursorMZ"           precision="5"/>
                        <column type="float"        field="sum(precursor intensity)"    label="PrecursorInt"         precision="5"/>
                        <column type="float"        field="RTMean"    label="RTMean"         width="3"/>
                        <column type="text"        field="AllGroups"    label="AllGroups"         width="3"/>
                        <column type="text"        field="DefaultGroups"    label="DefaultGroups"         width="5"/>
                        <column type="text"        field="LibraryID"    label="LibraryID"         width="20"/>
                        <column type="integer"        field="NumberOrganismIDs"    label="Hits"         width="1"/>
                </row>
                <row expander="image">
                  <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                      <parameter name="file"    file="spectra/specs_ms.mgf"/>
                      <parameter name="scan"    value="[cluster index]"/>
                      <parameter name="compoundname"    value="[LibraryID]"/>
                      <parameter name="trim" value="true"/>
                  </column>
                  <column type="stream" invoke="annotatedSpectrumImageText" contentType="text/plain" colspan="5">
                      <parameter name="file"    file="spectra/specs_ms.mgf"/>
                      <parameter name="scan"    value="[cluster index]"/>
                      <parameter name="compoundname"    value="[LibraryID]"/>
                      <parameter name="trim" value="true"/>
                  </column>
                </row>


                <row expander="down:up">
                  <column type="block" block="related_network_list_specnets" colspan="7">
                    <parameter name="spectraid" value="[cluster index]"/>
                  </column>
                </row>
        </block>


        <block id="clusters_list_specnets_withID_beta" type="table">
                <data>
                        <source type="file" name="clusterinfosummarygroup_attributes_withIDs_withcomponentID/"/>
                        <parsers>
                                <parser type="sortedTabular" sortBy="cluster index" operator="ascending"/>
                        </parsers>
                </data>
                <row>
                        <!--<column type="view" view="cluster_details" field="cluster index" label="ClusterIndex" width="18">
                                <parameter name="protein"   value="[cluster index]"/>
                                <parameter name="proteinID" value="[cluster index]"/>
                        </column>-->

                        <column label="ClusterIdx" type="genericurlgenerator" width="10" field="cluster index"> \
                            <parameter name="URLBASE" value="/ProteoSAFe/result.jsp"/>\
                            <parameter name="REQUESTPARAMETER=view" value="cluster_details"/>\
                            <parameter name="REQUESTPARAMETER=protein" value="[cluster index]"/>\
                            <parameter name="REQUESTPARAMETER=show" value="true"/>\
                            <parameter name="LABEL" value="Cluster - [cluster index]"/>\
                            <parameter name="USETASK" value="True"/>\
                        </column>\

                        <!--<column type="view" view="network_displayer" field="componentindex" label="Spec Family" width="5">
                                <parameter name="componentindex"   value="[componentindex]"/>
                        </column>-->
                        <column label="Spec Family" type="genericurlgenerator" width="10" field="componentindex"> \
                            <parameter name="URLBASE" value="/ProteoSAFe/result.jsp"/>\
                            <parameter name="REQUESTPARAMETER=view" value="network_displayer"/>\
                            <parameter name="REQUESTPARAMETER=componentindex" value="[componentindex]"/>\
                            <parameter name="REQUESTPARAMETER=highlight_node" value="[cluster index]"/>\
                            <parameter name="LABEL" value="View Network"/>\
                            <parameter name="USETASK" value="True"/>\
                            <parameter name="IGNORE_VALUE" value="-1"/>\
                            <parameter name="VALUE_TO_CONSIDER" value="[componentindex]"/>\
                        </column>\

                        <column type="parameterlink" target="result.jsp" label="AddToLibrary" includetask="true">
                          <parameter name="view" value="cluster_details"/>
                          <parameter name="protein" value="[cluster index]"/>
                        </column>

                        <column type="parameterlink" target="result.jsp" label="+Challenge" includetask="true">
                          <parameter name="view" value="cluster_details"/>
                          <parameter name="protein" value="[cluster index]"/>
                        </column>

                        <column type="integer"     field="number of spectra"        label="NumSpectra"          width="3"/>
                        <column type="integer"     field="UniqueFileSourcesCount"        label="NumFiles"          width="3"/>
                        <column type="float"       field="precursor mass"       label="PrecursorMZ"           precision="5"/>
                        <column type="float"        field="sum(precursor intensity)"    label="PrecursorInt"         precision="5"/>
                        <column type="float"        field="RTMean"    label="RTMean"         width="3"/>
                        <column type="text"        field="AllGroups"    label="AllGroups"         width="3"/>
                        <column type="text"        field="DefaultGroups"    label="DefaultGroups"         width="5"/>
                        <column type="integer"        field="EvenOdd"    label="EvenOdd"         width="5"/>
                        <column type="text"        field="LibraryID"    label="LibraryID"         width="20"/>
                        <column type="integer"        field="NumberOrganismIDs"    label="Hits"         width="1"/>

                        <column type="network_displayuniqueclusterfilenames">
                          <parameter name="all_files" value="[AllFiles]"/>
                        </column>
                </row>
                <row expander="image">
                <!--<column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                      <parameter name="file"    file="spectra/specs_ms.mgf"/>
                      <parameter name="scan"    value="[cluster index]"/>
                      <parameter name="compoundname"    value="[LibraryID]"/>
                      <parameter name="trim" value="true"/>
                  </column>
                  <column type="stream" invoke="annotatedSpectrumImageText" contentType="text/plain" colspan="5">
                      <parameter name="file"    file="spectra/specs_ms.mgf"/>
                      <parameter name="scan"    value="[cluster index]"/>
                      <parameter name="compoundname"    value="[LibraryID]"/>
                      <parameter name="trim" value="true"/>
                  </column>-->
                  <column type="jscolumnspectrumviewer" colspan="5">
                      <parameter name="file"    file="spectra/specs_ms.mgf"/>
                      <parameter name="scan"    value="[cluster index]"/>
                      <parameter name="compoundname"    value="[LibraryID]"/>
                      <parameter name="trim" value="true"/>
                  </column>
                </row>


                <row expander="down:up">
                  <column type="block" block="related_network_list_specnets" colspan="7">
                    <parameter name="spectraid" value="[cluster index]"/>
                  </column>
                </row>
        </block>

        <block id="results_per_cluster" type="table">
        <data>
            <source type="file" name="allclustered_spectra_info_withpath/"/>
            <parsers>
                <parser type="slicedTabular" groupBy="cluster index" sliceBy="{protein}"/>
            </parsers>
            <processors>
                <processor type="uploadFilename" field="AllFiles"/>
            </processors>
        </data>
        <row>
                        <column type="integer"     field="cluster index"         label="ClusterIndex"            width="3"/>
                        <column type="text"     field="AllFiles"        label="Filename"          width="10"/>
                        <column type="integer"     field="ScanNumber"        label="Scan"          width="3"/>
                        <column type="float"     field="sum(precursor intensity)"        label="Precursor Int"          precision="3"/>
                        <column type="float"     field="RTMean"        label="RT"          precision="3"/>
                        <column type="float"     field="parent mass"        label="Parent Mass"          precision="3"/>
                        <column type="mingplugin" target="/" label="+Challenge">
                          <parameter name="workflow" value="ADD-SINGLE-CHALLENGE"/>
                          <parameter name="ADDSPECTRA_EXTRACTSCAN" value="[ScanNumber]"/>
                          <parameter name="spec_on_server" value="[Original_Path]"/>
                        </column>
                        <column type="mingplugin" target="/" label="Gold">
                          <parameter name="workflow" value="ADD-SINGLE-ANNOTATED-GOLD"/>
                          <parameter name="ADDSPECTRA_EXTRACTSCAN" value="[ScanNumber]"/>
                          <parameter name="spec_on_server" value="[Original_Path]"/>
                        </column>
                        <column type="mingplugin" target="/" label="Silver">
                          <parameter name="workflow" value="ADD-SINGLE-ANNOTATED-SILVER"/>
                          <parameter name="ADDSPECTRA_EXTRACTSCAN" value="[ScanNumber]"/>
                          <parameter name="spec_on_server" value="[Original_Path]"/>
                        </column>
                        <column type="mingplugin" target="/" label="Bronze">
                          <parameter name="workflow" value="ADD-SINGLE-ANNOTATED-BRONZE"/>
                          <parameter name="ADDSPECTRA_EXTRACTSCAN" value="[ScanNumber]"/>
                          <parameter name="spec_on_server" value="[Original_Path]"/>
                        </column>


        </row>
        <row expander="image">
            <column type="jscolumnspectrumviewer" colspan="5">
                <parameter name="file"    file="[ProteosafeFilePath]"/>
                <parameter name="scan"    value="[ScanNumber]"/>
                <parameter name="peptide" value="*..*"/>
            </column>
            <!--
            <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                <parameter name="file"    file="[ProteosafeFilePath]"/>
                <parameter name="scan"    value="[ScanNumber]"/>
                <parameter name="peptide" value="*..*"/>
                <parameter name="trim" value="true"/>
            </column>-->
        </row>
        </block>




            <block id="related_network_list_specnets" type="table">
        <data>
            <source type="file" name="networkedges_display/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="Node2" operator="ascending"/>
                <parser type="slicedTabular" groupBy="Node1" sliceBy="{spectraid}"/>
            </parsers>
            <processors>
                <processor type="uploadFilename" field="SpectrumFile"/>
            </processors>
        </data>
        <row>
            <column type="integer"        field="Node1" label="Node Index"        width="10"/>
            <column type="integer"     field="Node2"         label="Neighbor Index"            width="10"/>
            <column type="float"       field="Cos_Score"       label="Cosine Score"           precision="5" />
            <column type="float"       field="MzDiff"           label="MzDiff"             precision="5"/>
        </row>
        <row expander="image">
            <column type="jscolumnspectrumviewer" colspan="5">
                <parameter name="file"    file="spectra/specs_ms.mgf"/>
                <parameter name="scan"    value="[Node1]"/>
                <parameter name="peptide" value="*..*"/>
            </column>
            <column type="jscolumnspectrumviewer" colspan="5">
                <parameter name="file"    file="spectra/specs_ms.mgf"/>
                <parameter name="scan"    value="[Node2]"/>
                <parameter name="peptide" value="*..*"/>
            </column>
        </row>
        </block>

        <block id="network_pairs_specnets" type="table">
                <data>
                        <source type="file" name="networkedges_display_pairs/"/>
                        <parsers>
                                <parser type="sortedTabular" sortBy="Node1" operator="ascending"/>
                        </parsers>
                </data>
                <row>
                        <column type="integer"        field="Node1" label="Node1"        width="10"/>
                        <column type="integer"        field="Node2" label="Node2"        width="10"/>
                        <column type="float"       field="Cos_Score"       label="Cosine Score"           precision="5" />
                        <column type="float"       field="MzDiff"           label="MzDiff"             precision="5"/>
                </row>

                <row expander="image">
                    <!--<column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                        <parameter name="file"    file="[FileName]"/>
                        <parameter name="scan"    value="[Node1]"/>
                        <parameter name="peptide" value="*..*"/>
                        <parameter name="trim" value="true"/>
                    </column>
                    <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                        <parameter name="file"    file="[FileName]"/>
                        <parameter name="scan"    value="[Node2]"/>
                        <parameter name="peptide" value="*..*"/>
                        <parameter name="trim" value="true"/>
                    </column>-->
                    <column type="jscolumnspectrumviewer" colspan="5">
                        <parameter name="file"    file="spectra/specs_ms.mgf"/>
                        <parameter name="scan"    value="[Node1]"/>
                        <parameter name="peptide" value="*..*"/>
                    </column>
                    <column type="jscolumnspectrumviewer" colspan="5">
                        <parameter name="file"    file="spectra/specs_ms.mgf"/>
                        <parameter name="scan"    value="[Node2]"/>
                        <parameter name="peptide" value="*..*"/>
                    </column>
                    <column type="jscolumnspectrumviewer_spectrum_comparison" colspan="5">
                            <parameter name="spectrum1_type"    value="flatfile"/>
                            <parameter name="spectrum1_file"    file="spectra/specs_ms.mgf"/>
                            <parameter name="spectrum1_scan"    value="[Node1]"/>
                            <parameter name="spectrum2_type"    value="flatfile"/>
                            <parameter name="spectrum2_file"    file="spectra/specs_ms.mgf"/>
                            <parameter name="spectrum2_scan"    value="[Node2]"/>
                    </column>
                </row>
        </block>

        <view id="network_pairs_specnets_allcomponents" label="View Network Pairs All Component" display="hidden">
                <blockRef id="main" type="network_pairs_specnets_allcomponents"/>
        </view>

        <block id="network_pairs_specnets_allcomponents" type="table">
                <data>
                        <source type="file" name="networkedges_selfloop/"/>
                        <parsers>
                                <parser type="sortedTabular" sortBy="CLUSTERID1" operator="ascending"/>
                        </parsers>
                </data>
                <row>
                        <column type="integer"        field="CLUSTERID1" label="Node1"        width="10"/>
                        <column type="integer"        field="CLUSTERID2" label="Node2"        width="10"/>
                        <column type="float"       field="Cosine"       label="Cosine Score"           precision="5" />
                        <column type="float"       field="DeltaMZ"           label="MzDiff"             precision="5"/>
                        <column type="integer"       field="ComponentIndex"           label="ComponentIndex"             width="1"/>
                </row>

                <row expander="image">
                    <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                        <parameter name="file"    file="[FileName]"/>
                        <parameter name="scan"    value="[Node1]"/>
                        <parameter name="peptide" value="*..*"/>
                        <parameter name="trim" value="true"/>
                    </column>
                    <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                        <parameter name="file"    file="[FileName]"/>
                        <parameter name="scan"    value="[Node2]"/>
                        <parameter name="peptide" value="*..*"/>
                        <parameter name="trim" value="true"/>
                    </column>
                </row>
        </block>

        <view id="network_pairs_specnets_componentsliced" label="View Network Pairs Component Sliced" display="hidden">
                <blockRef id="main" type="network_pairs_specnets_componentsliced"/>
        </view>


        <block id="network_pairs_specnets_componentsliced" type="table">
                <data>
                        <source type="file" name="networkedges_selfloop/"/>
                        <parsers>
                                <parser type="sortedTabular" sortBy="CLUSTERID1" operator="ascending"/>
                                <parser type="slicedTabular" groupBy="ComponentIndex" sliceBy="{componentindex}"/>
                        </parsers>
                </data>
                <row>
                        <column type="integer"        field="CLUSTERID1" label="Node1"        width="10"/>
                        <column type="integer"        field="CLUSTERID2" label="Node2"        width="10"/>
                        <column type="float"       field="Cosine"       label="Cosine Score"           precision="5" />
                        <column type="float"       field="DeltaMZ"           label="MzDiff"             precision="5"/>
                        <column type="integer"       field="ComponentIndex"           label="MzDiff"             width="1"/>
                </row>

                <row expander="image">
                    <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                        <parameter name="file"    file="[FileName]"/>
                        <parameter name="scan"    value="[Node1]"/>
                        <parameter name="peptide" value="*..*"/>
                        <parameter name="trim" value="true"/>
                    </column>
                    <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                        <parameter name="file"    file="[FileName]"/>
                        <parameter name="scan"    value="[Node2]"/>
                        <parameter name="peptide" value="*..*"/>
                        <parameter name="trim" value="true"/>
                    </column>
                </row>
        </block>

        <view id="cluster_info_sliced" label="View Clusters Sliced" display="hidden">
                <blockRef id="main" type="cluster_info_sliced"/>
        </view>


        <block id="cluster_info_sliced" type="table">
                <data>
                        <source type="file" name="clusterinfosummarygroup_attributes_withIDs_withcomponentID/"/>
                        <parsers>
                                <parser type="sortedTabular" sortBy="cluster index" operator="ascending"/>
                                <parser type="slicedTabular" groupBy="componentindex" sliceBy="{componentindex}"/>
                        </parsers>
                </data>
                <row>
                        <!--<column type="view" view="cluster_details" field="cluster index" label="ClusterIndex" width="18">
                                <parameter name="protein"   value="[cluster index]"/>
                                <parameter name="proteinID" value="[cluster index]"/>
                        </column>-->

                        <column label="ClusterIdx" type="genericurlgenerator" width="10" field="cluster index"> \
                            <parameter name="URLBASE" value="/ProteoSAFe/result.jsp"/>\
                            <parameter name="REQUESTPARAMETER=view" value="cluster_details"/>\
                            <parameter name="REQUESTPARAMETER=protein" value="[cluster index]"/>\
                            <parameter name="LABEL" value="Cluster - [cluster index]"/>\
                            <parameter name="USETASK" value="True"/>\
                        </column>\

                        <!--<column type="view" view="network_displayer" field="componentindex" label="Spec Family" width="5">
                                <parameter name="componentindex"   value="[componentindex]"/>
                        </column>-->
                        <column label="Spec Family" type="genericurlgenerator" width="10" field="componentindex"> \
                            <parameter name="URLBASE" value="/ProteoSAFe/result.jsp"/>\
                            <parameter name="REQUESTPARAMETER=view" value="network_displayer"/>\
                            <parameter name="REQUESTPARAMETER=componentindex" value="[componentindex]"/>\
                            <parameter name="LABEL" value="View Network"/>\
                            <parameter name="USETASK" value="True"/>\
                            <parameter name="IGNORE_VALUE" value="-1"/>\
                            <parameter name="VALUE_TO_CONSIDER" value="[componentindex]"/>\
                        </column>\

                        <column type="parameterlink" target="result.jsp" label="AddToLibrary" includetask="true">
                          <parameter name="view" value="cluster_details"/>
                          <parameter name="protein" value="[cluster index]"/>
                        </column>

                        <column type="parameterlink" target="result.jsp" label="+Challenge" includetask="true">
                          <parameter name="view" value="cluster_details"/>
                          <parameter name="protein" value="[cluster index]"/>
                        </column>

                        <column type="integer"     field="number of spectra"        label="NumSpectra"          width="3"/>
                        <column type="integer"     field="UniqueFileSourcesCount"        label="NumFiles"          width="3"/>
                        <column type="float"       field="precursor mass"       label="PrecursorMZ"           precision="5"/>
                        <column type="float"        field="sum(precursor intensity)"    label="PrecursorInt"         precision="5"/>
                        <column type="float"        field="RTMean"    label="RTMean"         width="3"/>
                        <column type="text"        field="AllGroups"    label="AllGroups"         width="3"/>
                        <column type="text"        field="DefaultGroups"    label="DefaultGroups"         width="5"/>
                        <column type="integer"        field="EvenOdd"    label="EvenOdd"         width="5"/>
                        <column type="text"        field="LibraryID"    label="LibraryID"         width="20"/>
                        <column type="integer"        field="NumberOrganismIDs"    label="Hits"         width="1"/>
                </row>
                <row expander="image">
<!--                  <column type="stream" invoke="annotatedSpectrumImageThumbnail" contentType="image/png" colspan="5">
                      <parameter name="file"    file="spectra/specs_ms.mgf"/>
                      <parameter name="scan"    value="[cluster index]"/>
                      <parameter name="compoundname"    value="[LibraryID]"/>
                      <parameter name="trim" value="true"/>
                  </column>
                  <column type="stream" invoke="annotatedSpectrumImageText" contentType="text/plain" colspan="5">
                      <parameter name="file"    file="spectra/specs_ms.mgf"/>
                      <parametbiomer name="scan"    value="[cluster index]"/>
                      <parameter name="compoundname"    value="[LibraryID]"/>
                      <parameter name="trim" value="true"/>
                  </column>-->
                  <column type="jscolumnspectrumviewer" colspan="5">
                      <parameter name="file"    file="spectra/specs_ms.mgf"/>
                      <parameter name="scan"    value="[cluster index]"/>
                      <parameter name="compoundname"    value="[LibraryID]"/>
                      <parameter name="trim" value="true"/>
                  </column>
                </row>


                <row expander="down:up">
                  <column type="block" block="related_network_list_specnets" colspan="7">
                    <parameter name="spectraid" value="[cluster index]"/>
                  </column>
                </row>
        </block>




        <view id="powerview"  display="hidden">
                <blockRef id="main" type="powerview"/>
        </view>

        <!-- Block definitions -->
        <block id="powerview" type="powerview">
            <data>
              <source type="file" name="result/"/>
              <parsers>
                  <parser type="stream" contentType="text/xml"/>
              </parsers>
            </data>
        </block>

        <view id="network_statistics"  label="Networking Statistics" group="Auxiliary Views">
                <blockRef id="main" type="network_statistics"/>
        </view>
        <block id="network_statistics" type="stream" panelHeight="600px">
            <data>
                <source type="file" name="network_statistics/"/>
                <parsers>
                    <parser type="stream" contentType="text/plain"/>
                </parsers>
            </data>
        </block>


        <view id="network_displayer"  label="Network Display (Alpha)" display="hidden">
                <blockRef id="main" type="network_displayer"/>
        </view>
        <block id="network_displayer" type="network_displayer" display="hidden">
            <data>
                <source type="file" name="result/"/>
                <parsers>
                    <parser type="stream" contentType="text/plain"/>
                </parsers>
            </data>
        </block>





        <view id="pairs_histogram" label="Network Summarizing Graphs" group="Network Visualizations">
                <blockRef id="main" type="pairs_histogram"/>
        </view>

        <block id="pairs_histogram" type="chartdisplayer">
            <data>
                <source type="file" name="result/"/>
                <parsers>
                    <parser type="stream" contentType="text/plain"/>
                </parsers>
            </data>
        </block>


        <view id="parameters_xml_grabber"  label="parameters_xml_grabber" display="hidden">
                <blockRef id="main" type="parameters_xml_grabber"/>
        </view>
        <block id="parameters_xml_grabber" type="stream" panelHeight="600px">
            <data>
                <source type="file" name="params/"/>
                <parsers>
                    <parser type="stream" contentType="text/plain"/>
                </parsers>
            </data>
        </block>





    <view id="view_raw_spectra" label="View Raw Spectra" group="Experimental Views">
            <blockRef id="main"   type="view_raw_spectra"/>
    </view>

    <block id="view_raw_spectra" type="table">
            <data>
                <source type="file" name="allclustered_spectra_info_withpath/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="cluster index" operator="ascending"/>
            </parsers>
            <processors>
                <processor type="uploadFilename" field="AllFiles"/>
            </processors>
        </data>
        <row>
                    <column type="integer"     field="cluster index"         label="ClusterIndex"            width="3"/>
                    <column type="text"     field="AllFiles"        label="Filename"          width="10"/>
                    <column type="integer"     field="ScanNumber"        label="Scan"          width="3"/>
                    <column type="float"     field="sum(precursor intensity)"        label="Precursor Int"          precision="3"/>
                    <column type="float"     field="RTMean"        label="RT"          precision="3"/>
                    <column type="float"     field="parent mass"        label="Parent Mass"          precision="3"/>
        </row>
        <row expander="image">
            <column type="jscolumnspectrumviewer" colspan="5">
                <parameter name="file"    file="[ProteosafeFilePath]"/>
                <parameter name="scan"    value="[ScanNumber]"/>
                <parameter name="peptide" value="*..*"/>
            </column>
        </row>
    </block>









    <view id="view_ili" label="View ili in GNPS" group="Advanced Views - Third Party Visualization">
        <blockRef id="main" type="view_ili"/>
    </view>
    <block id="view_ili" type="streamhtmlframe">
        <data>
            <source type="file" name="view_ili/"/>
            <parsers>
                <parser type="stream" contentType="text/html"/>
            </parsers>
        </data>
    </block>

    <!-- Ili Output -->
    <view id="download_ili_abundance" label="Download ili Data" group="Export">
            <blockRef id="main"   type="download_ili_abundance"/>
    </view>

    <block id="download_ili_abundance" type="dummydownload">
      <data>
        <source type="file" name="ili_output/"/>
         <parsers>
            <parser type="stream" contentType="text/xml"/>
        </parsers>
      </data>
    </block>


    <!-- Compound Occurrence -->
    <view id="view_compound_occurrence" label="View Compounds and File Occurrence" group="Auxiliary Views">
            <blockRef id="main"   type="view_compound_occurrence"/>
    </view>

    <block id="view_compound_occurrence" type="table">
            <data>
                <source type="file" name="compound_filename_occurences/"/>
            <parsers>
                <parser type="sortedTabular" sortBy="TotalFiles" operator="ascending"/>
            </parsers>
        </data>
        <row>
                    <column type="text"     field="LibraryID"        label="LibraryID"          width="10"/>
                    <column type="integer"     field="TotalFiles"        label="TotalFiles"          width="3"/>
        </row>
    </block>







</interface>
